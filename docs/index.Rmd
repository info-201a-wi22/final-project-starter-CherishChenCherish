---
title: "Vaccine Data"
author: "Jeff Ngaruiya,Cherish Chen,Hyewon Sim,Merek Gregory Mecham"
date: "2/17/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## What is this file for?

* This file will eventually become your project report for **P02: Exploratory Data Analysis**. Specifically, you will write rmarkdown to report your exploratory data analysis.

* Please see Canvas for more details.

## ACCESSING THE /source DIRECTORY
### Example 1: Source some code and run a function
```{r}
# Example 1: Note relative path, which can be read: Up one
# directory(..), down into source (/source), and 
# then "source" an R file (data_access.R)
source("../source/data_access.R")
data_access_test()
```

### Example 2: Initialize a variable and then use it
```{r}
# Example 1: This function was "sourced" above
msg <- data_access_test(" Morgan!")
```

> `r msg` Hope you have a good day!! 

## ABOUT THIS FILE: 

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```
# Summary
From the dataset we found that within the **19 columns** and  **35402 rows**,Looking at the dataset we calculated the total doses and the total different vaccines to find the maximum vaccines that were administered in U.S counties. 

Looking at our histogram chart we concluded that there were a lot more people that didnâ€™t get vaccinated compared to those who did get vaccinated. 

In addition we created our three scatter plots in order to find the relationship between the number of people who got the moderna, pfizer and johnson & johnson in relation to their booster shot. 

When we evaluated our three scatterplots we concluded that people were getting their booster shots because the slopes on the graph were increasing positively. Which means that the vaccines were effective because people were getting their booster shots. Also we grouped each different vaccines and we summarized by the maximum and made an aggregated table. 

# Table
```{r pressure, echo=FALSE}
library(readr)
library(dplyr)
library(knitr)
library(tidyverse)

vaccines <- read.csv("https://data.chhs.ca.gov/dataset/e283ee5a-cf18-4f20-a92c-ee94a2866ccd/resource/130d7ba2-b6eb-438d-a412-741bde207e1c/download/covid19vaccinesbycounty.csv")
View(vaccines)

df <- vaccines %>%
  select(county, administered_date, total_doses, moderna_doses, pfizer_doses, jj_doses, booster_recip_count) %>%
  group_by(county) %>%
  summarize(Total_doses = sum(total_doses),
            Max_doses = max(total_doses),
            Min_doses = min(total_doses),
            Median_doses = median(total_doses),
            most_recent_doses = last(total_doses),
            total_Pfizer_doses = sum(pfizer_doses),
            total_moderna_doses = sum(moderna_doses),
            total_Johnson_doses = sum(jj_doses))
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
vaccines <- read.csv("https://data.chhs.ca.gov/dataset/e283ee5a-cf18-4f20-a92c-ee94a2866ccd/resource/130d7ba2-b6eb-438d-a412-741bde207e1c/download/covid19vaccinesbycounty.csv")

latest_total_doses <- filter(vaccines, administered_date == max(vaccines$administered_date))
latest_total_doses <- latest_total_doses[-c(1, 2), ]
hist(latest_total_doses$total_doses,
  main = "Histogram for Total doses in different counties",
  xlab = "total doses",
  ylab = "frequency of counties",
  border = "blue",
  col = "green",
  las = 1,
  breaks = 15,
)
```

```{r pressure, echo=FALSE}
vaccines <- read.csv("https://data.chhs.ca.gov/dataset/e283ee5a-cf18-4f20-a92c-ee94a2866ccd/resource/130d7ba2-b6eb-438d-a412-741bde207e1c/download/covid19vaccinesbycounty.csv")

#install.packages("cowplot")
library(ggplot2)
library(cowplot)

p_m <-ggplot(vaccines, aes(x=pfizer_doses, y=moderna_doses)) + 
  geom_point() +
  geom_smooth(method = lm, formula = y ~ splines::bs(x, 3), se = FALSE) +
  labs(title = "Moderna vs Pfizer")

m_jj <- ggplot(vaccines, aes(x=moderna_doses, y=jj_doses)) + 
  geom_point() +
  geom_smooth(method = lm, formula = y ~ splines::bs(x, 3), se = FALSE) +
  labs(title = "JJ vs Moderna")

p_jj <- ggplot(vaccines, aes(x=pfizer_doses, y=jj_doses)) + 
  geom_point() +
  geom_smooth(method = lm, formula = y ~ splines::bs(x, 3), se = FALSE)+
  labs(title = "JJ vs Pfizer") 

title <- ggdraw() + draw_label("Relationship between Vaccines", fontface='bold')
bottom_row <- plot_grid(p_jj, m_jj, ncol = 2, labels = "AUTO")
plot_grid(title, bottom_row, p_m, nrow = 3, labels = c("", "", "C"),
          rel_heights = c(0.2, 1, 1))
```



Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
