---
title: "Vaccine Data"
author: "Jeff Ngaruiya,Cherish Chen,Hyewon Sim,Merek Gregory Mecham"
date: "2/17/2022"
output: html_document
---


# Summary
From the dataset we found that within the **19 columns** and  **35402 rows**,Looking at the dataset we calculated the total doses and the total different vaccines to find the maximum vaccines that were administered in U.S counties. 

Looking at our histogram chart we concluded that there were a lot more people that didnâ€™t get vaccinated compared to those who did get vaccinated. 

In addition we created our three scatter plots in order to find the relationship between the number of people who got the moderna, pfizer and johnson & johnson in relation to their booster shot. 

When we evaluated our three scatterplots we concluded that people were getting their booster shots because the slopes on the graph were increasing positively. Which means that the vaccines were effective because people were getting their booster shots. Also we grouped each different vaccines and we summarized by the maximum and made an aggregated table. 

# Table
```{r kable_table, echo=FALSE}
library("knitr")
vaccines <- read.csv("https://data.chhs.ca.gov/dataset/e283ee5a-cf18-4f20-a92c-ee94a2866ccd/resource/130d7ba2-b6eb-438d-a412-741bde207e1c/download/covid19vaccinesbycounty.csv")
library(dplyr)
df <- vaccines %>%
  select(county, administered_date, total_doses, moderna_doses, pfizer_doses, jj_doses, booster_recip_count) %>%
  group_by(county) %>%
  summarize(Total_doses = sum(total_doses),
            Max_doses = max(total_doses),
            Min_doses = min(total_doses),
            Median_doses = median(total_doses),
            most_recent_doses = last(total_doses),
            total_Pfizer_doses = sum(pfizer_doses),
            total_moderna_doses = sum(moderna_doses),
            total_Johnson_doses = sum(jj_doses))
kable(df)
```

## Including Plots

You can also embed plots, for example:

```{r plot_histogram, echo=FALSE}
latest_total_doses <- filter(vaccines, administered_date == max(vaccines$administered_date))
latest_total_doses <- latest_total_doses[-c(1, 2), ]
hist(latest_total_doses$total_doses,
  main = "Histogram for Total doses in different counties",
  xlab = "total doses",
  ylab = "frequency of counties",
  border = "blue",
  col = "green",
  las = 1,
  breaks = 15,
)
```


```{r plot_scatter, echo=FALSE}
vaccines <- read.csv("https://data.chhs.ca.gov/dataset/e283ee5a-cf18-4f20-a92c-ee94a2866ccd/resource/130d7ba2-b6eb-438d-a412-741bde207e1c/download/covid19vaccinesbycounty.csv")

library("cowplot")
library(ggplot2)


Pfizer_booster <-ggplot(vaccines, aes(x=booster_recip_count, y=pfizer_doses)) +
  geom_point() +
  geom_smooth(method = lm, formula = y ~ splines::bs(x, 3), se = FALSE) +
  labs(title = "booster vs Pfizer")

moderna_booster <- ggplot(vaccines, aes(x=booster_recip_count, y= moderna_doses)) +
                            geom_point() +
                            geom_smooth(method = lm, formula = y ~ splines::bs(x, 3), se = FALSE) +
                            labs(title = "booster vs Moderna")
       

jj_booster <- ggplot(vaccines, aes(x= booster_recip_count, y=jj_doses)) + 
  geom_point() +
  geom_smooth(method = lm, formula = y ~ splines::bs(x, 3), se = FALSE) +
  labs(title = "booster vs JJ")


title <- ggdraw() + draw_label("Vaccines vs Booster shot", fontface='bold')
bottom_row <- plot_grid(Pfizer_booster, moderna_booster, ncol = 2, labels = "AUTO")
plot_grid(title, bottom_row, jj_booster, nrow = 3, labels = c("", "", "C"),
          rel_heights = c(0.2, 1, 1))

```



Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.